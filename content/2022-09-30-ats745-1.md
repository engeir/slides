---
date: "2022-09-30"
author: Eirik Rolland Enger
event: ATS745 Course
title: "Presentation 1: Atmosphere and Ocean in CESM2"
revealOptions:
  allottedTime: 1200000
---

<!-- zoomLevel: 2.5 -->
<!-- 20 mins -->

## Atmosphere and ocean in CESM2
<!-- .element class="r-fit-text" -->

Eirik Enger, ATS745

---

### History

<!-- .element class="r-fit-text" -->

--

<!-- ### How old is the model? -->

Released in June 2018
<!-- .element class="r-fit-text" -->

<!-- # What is its family history? -->

| CESM2 | CESM1 | CCSM4 | CCSM3 | CCSM2 | CSM1 | CCM3 | CCM2 | CCM1 | CCM0 |
| :---: | :---: | :---: | :---: | :---: | :--: | :--: | :--: | :--: | :--: |
| 2018  | 2010  | 2010  | 2004  | 2002  | 1996 | 1996 | 1992 | 1987 | 1983 |

<!-- .element class="r-fit-text" -->

<a href="https://doi.org/10.1029/2019MS001916"
data-citation-key="@danabasoglu2020">Danabasoglu, G. et al. (2020)</a>,
<a href="https://journals.ametsoc.org/view/journals/clim/19/11/jcli3761.1.xml"
data-citation-key="@collins2006">Collins, W. D. et al. (2006)</a>,
<a href="https://journals.ametsoc.org/view/journals/clim/11/6/1520-0442_1998_011_1115_tncsmv_2.0.co_2.xml"
data-citation-key="@boville1998">Boville, B. A. and Gent, P. R. (1998)</a>,
<a href="https://www.cesm.ucar.edu/models/cesm1.0/notable_improvements.html">CESM
improvements</a>,
<a href="https://ncar.github.io/CAM/doc/build/html/cam6_scientific_guide/introduction.html#ccm0-and-ccm1">
CAM documentation</a>,
<a href="https://www.cgd.ucar.edu/cms/ccm3/history.shtml">CCM3 history</a>

<!-- .element: style="font-size:13pt" -->

Notes:

Released four years ago

<!-- Family: "https://www.cesm.ucar.edu/models/cesm1.0/notable_improvements.html" -->
<!-- Collins et al. (2006), The Community Climate System Model Version 3 (2006) -->
<!-- Boville and Gent 1998 -->
<!-- "https://ncar.github.io/CAM/doc/build/html/cam6_scientific_guide/introduction.html#ccm0-and-ccm1" -->
<!-- History of CCM: "https://www.cgd.ucar.edu/cms/ccm3/history.shtml" -->
<!-- CCM0 <- {Australian spectral model, ECMWF} -->

--

<!-- Is it closely related to other models? -->

NorESM (from CESM2.1)
<!-- .element class="r-fit-text" -->

<span class="r-fit-text">
<span class="fragment">
Differences: ocean model and aerosol module
</span>
</span>

E3SM (from CESM1)
<!-- .element class="r-fit-text" -->

<span class="r-fit-text">
<span class="fragment">
Similarities: atm. model is based on CAM5, MOSART used in both
</span>
</span>

<a href="https://noresm-docs.readthedocs.io/en/noresm2/model-description/overview.html?highlight=cesm#overview">noresm-docs.readthedocs.io</a>,
<a href="https://e3sm.org/model/e3sm-model-description/">e3sm.org</a>

<!-- .element: style="font-size:13pt" -->

Notes:

<!-- NorESM: "https://noresm-docs.readthedocs.io/en/noresm2/model-description/overview.html?highlight=cesm#overview" -->
<!-- E3SM: "https://e3sm.org/model/e3sm-model-description/" -->

---

### Equations
<!-- .element class="r-fit-text" -->

--

<!-- TODO: -->

What equation set is used?
<!-- .element class="r-fit-text" -->

--

_Is the atmosphere model quasi-static?_
<!-- .element class="r-fit-text" -->

The $\eta$-system uses an approximation to the hydrostatic equation written as

$$
\Phi_k=\Phi_s+R\sum_{\ell=k}^K H_{k\ell}(p)T_{v\ell}
$$

<a href="https://ncar.github.io/CAM/doc/build/html/cam6_scientific_guide/dynamics.html?highlight=coriolis#vertical-coordinate-and-hydrostatic-equation">
ncar.github.io</a>

<!-- .element style="font-size:13pt" -->

Notes:

...where $k$ is the vertical grid index running from $1$ at the top of the model to $K$
at the first model level above the surface, $\Phi_k$ is the geopotential at level $k$,
$\Phi_s$ is the surface geopotential, $T_v$ is the virtual temperature, and $R$ is the
gas constant. The matrix $H$, referred to as the hydrostatic matrix, represents the
discrete approximation to the hydrostatic integral and is left unspecified for now. It
depends on pressure, which varies from horizontal point to point.

---

### Discretization
<!-- .element class="r-fit-text" -->

--

![Spectral element grid](https://raw.githubusercontent.com/engeir/presentations/at745-1/2022/at745/1/assets/spectral-element-grid.png)
<!-- .element: class="r-stretch" -->

Notes:

Illustration of the cubed sphere grid / spectral element grid for Earth.

--

<!-- TODO: -->

_How is the sphere discretized for the atmosphere and for the ocean?_
<!-- .element class="r-fit-text" -->

- CAM uses the cubed sphere, optionally a "continuous Galerkin spectral finite element
  method"

- In POP2, SH uses spherical coordinates and NH ...?

<!-- .element class="r-fit-text" -->

<a
href="https://ncar.github.io/CAM/doc/build/html/cam6_scientific_guide/dynamics.html#horizontal-discretization-functional-spaces and https://ncar.github.io/CAM/doc/build/html/cam6_scientific_guide/dynamics.html#spectral-element-dynamical-core">
ncar.github.io</a>,
<a
href="https://doi.org/10.1177/1094342005056108" data-citation-key="@dennis2005">
Dennis, J. et al. (2005)</a>,
<a href="https://doi.org/10.1029/2019MS001916"
data-citation-key="@danabasoglu2020">Danabasoglu, G. et al. (2020)</a>

<!-- .element: style="font-size:13pt" -->

Notes:

Spectral method may be the way forward? Said something about that in class.

--

<!-- TODO: -->

_What horizontal grid spacings are typically used for the atmosphere and for the ocean?_
<!-- .element class="r-fit-text" -->

<!-- Ocean -->

- Uses a B-grid

<a data-citation-key="@smith2010">Smith, R. and Gent, P. (2010)</a>

<!-- .element: style="font-size:13pt" -->

--

<!-- TODO: -->

_What vertical coordinate is used for the atmosphere and for the ocean?_
<!-- .element class="r-fit-text" -->

- Atmosphere
  - Quasi-Lagrangian, like the $\eta$-coordinate, a hybrid $\sigma$-$p$-coordinate, used
    elsewhere in CAM
  - Discretized with a Lorenz staggering
  - Finite volume (FV) dynamics are time-split
- Ocean

<!-- .element class="r-fit-text" -->

<a href="https://ncar.github.io/CAM/doc/build/html/cam6_scientific_guide/dynamics.html#a-vertically-lagrangian-and-horizontally-eulerian-control-volume-discretization-of-the-hydrodynamics">
ncar.github.io</a>
<!-- .element: style="font-size:13pt" -->

Notes:

"https://ncar.github.io/CAM/doc/build/html/cam6_scientific_guide/dynamics.html#a-vertically-lagrangian-and-horizontally-eulerian-control-volume-discretization-of-the-hydrodynamics"
"https://ncar.github.io/CAM/doc/build/html/cam6_scientific_guide/dynamics.html#vertical-discretization"
"https://ncar.github.io/CAM/doc/build/html/cam6_scientific_guide/dynamics.html#overview"

--

_Does the atmosphere model include the stratosphere?_
<!-- .element class="r-fit-text" -->

Yes, CAM ends at 2.26 hPa (40 km), while WACCM ends at 4.5⨯10⁻⁶ hPa.
Both include at least parts of the stratosphere.
<!-- .element class="r-fit-text" -->

<a href="https://doi.org/10.1029/2019MS001916"
data-citation-key="@danabasoglu2020">Danabasoglu, G. et al. (2020)</a>
<!-- .element: style="font-size:13pt" -->

--

_How many layers are typically used with the atmosphere and ocean models?_
<!-- .element class="r-fit-text" -->

- CAM6 uses 32 layers, WACCM6 70 layers
- POP2 has 60 levels down to 5500 m, 10 m resolution down to 160, then it increases
  monotonically to 250 m at 3500 m

<!-- .element class="r-fit-text" -->

<a href="https://doi.org/10.1029/2019MS001916"
data-citation-key="@danabasoglu2020">Danabasoglu, G. et al. (2020)</a>

<!-- .element: style="font-size:13pt" -->

--

<!-- TODO: -->

<!-- What are the prognostic variables of the atmosphere model, and the ocean model? -->
<!-- Prognostic variables -->

| CAM (atm.) | POP (ocn.) |
| - | - |
| Pressure (+ gradient) | Pressure (+ gradient) |
| Velocity $\times 3$ | Velocity $\times 3$ |
| Temperature | Potential temperature |
| Specific humidity | |
| Vorticity | Vorticity |
| Divergence | |
| Surface geopotential |  |
| Advection | |
| | Density |
| | Barotropic velocities |
<!-- .element: style="font-size:19pt" -->

<!-- - Temperature, perturbation surface pressure ($\ln p_s$) -->
<!-- - ps, u3, v3, t3, q3, qminus, vort, div, dpsl, dpsm, dps, omga, phis, hadv, pdeld -->
<!-- Ocean: -->
<!-- - Velocity ($u$, $v$, $w$), pressure ($p$), density ($\rho$), potential temperature -->
<!--   ($\Theta$), salinity ($S$) -->

<a href="https://github.com/ESCOMP/CAM/blob/cam_cesm2_1_rel/src/dynamics/eul/prognostics.F90">github.com</a>,
<a href="https://ncar.github.io/POP/doc/build/html/reference_manual/POPRefManual.html#the-primitive-equations-in-general-coordinates">
ncar.github.io</a>

<!-- .element: style="font-size:13pt" -->

Notes:

Here, ps is pressure, u3 and v3 are horizontal wind velocity, t3 is temperature, q3 is
specific humidity (water vapor) and other constituents, qminus is (constituents on
previous step?), vort is vorticity, div is divergence, dpsl is longitudinal pressure
gradient, dpsm is meridional pressure gradient, dps is pressure gradient, omga is
vertical velocity, phis is surface geopotential, hadv is horizontal advection, pdeld is
dry pressure difference for dry-type constituents (only used when called from eularian
dynamics).


<!-- "https://ncar.github.io/POP/doc/build/html/reference_manual/POPRefManual.html#the-primitive-equations-in-general-coordinates" -->

---

### Model components
<!-- .element class="r-fit-text" -->

--

<!-- TODO: -->

Does the model have an interactive carbon cycle?
<!-- .element class="r-fit-text" -->

--

![](https://raw.githubusercontent.com/engeir/presentations/at745-1/2022/at745/1/assets/component-models.png)

--

_What land surface model is used?_
<!-- .element class="r-fit-text" -->

- Community Land Model, v5 (CLM5)

<!-- .element class="r-fit-text" -->

<a href="https://doi.org/10.1029/2019MS001916"
data-citation-key="@danabasoglu2020">Danabasoglu, G. et al. (2020)</a>

<!-- .element: style="font-size:13pt" -->

--

<!-- TODO: -->

_Are continental ice sheets included?_
<!-- .element class="r-fit-text" -->

<!-- Start adding with revealjs-make-reflist -->
<!-- Generated by revealjs-make-reflist. Do not edit. -->

---

### References

<div class="csl-entry" id="ref-boville1998" role="doc-biblioentry">
Boville, Byron A., and Peter R. Gent. 1998. <span>“The <span>NCAR</span> Climate System Model, Version One.”</span> <em>Journal of Climate</em> 11 (6): 1115–30. <a href="https://doi.org/10.1175/1520-0442(1998)011&lt;1115:TNCSMV&gt;2.0.CO;2">https://doi.org/10.1175/1520-0442(1998)011&lt;1115:TNCSMV&gt;2.0.CO;2</a>.
</div>
<!-- .element: style="font-size:20pt" -->
<div class="csl-entry" id="ref-collins2006" role="doc-biblioentry">
Collins, William D., Cecilia M. Bitz, Maurice L. Blackmon, Gordon B. Bonan, Christopher S. Bretherton, James A. Carton, Ping Chang, et al. 2006. <span>“The Community Climate System Model Version 3 (<span>Ccsm3</span>).”</span> <em>Journal of Climate</em> 19 (11): 2122–43. <a href="https://doi.org/10.1175/JCLI3761.1">https://doi.org/10.1175/JCLI3761.1</a>.
</div>
<!-- .element: style="font-size:20pt" -->
<div class="csl-entry" id="ref-danabasoglu2020" role="doc-biblioentry">
Danabasoglu, G., J.-F. Lamarque, J. Bacmeister, D. A. Bailey, A. K. DuVivier, J. Edwards, L. K. Emmons, et al. 2020. <span>“The Community Earth System Model Version 2 (<span>Cesm2</span>).”</span> <em>Journal of Advances in Modeling Earth Systems</em> 12 (2): e2019MS001916. https://doi.org/<a href="https://doi.org/10.1029/2019MS001916">https://doi.org/10.1029/2019MS001916</a>.
</div>
<!-- .element: style="font-size:20pt" -->

--

<div class="csl-entry" id="ref-dennis2005" role="doc-biblioentry">
Dennis, John, Aimé Fournier, William F. Spotz, Amik St-Cyr, Mark A. Taylor, Stephen J. Thomas, and Henry Tufo. 2005. <span>“High-Resolution Mesh Convergence Properties and Parallel Efficiency of a Spectral Element Atmospheric Dynamical Core.”</span> <em>The International Journal of High Performance Computing Applications</em> 19 (3): 225–35. <a href="https://doi.org/10.1177/1094342005056108">https://doi.org/10.1177/1094342005056108</a>.
</div>
<!-- .element: style="font-size:20pt" -->
<div class="csl-entry" id="ref-smith2010" role="doc-biblioentry">
Smith, R, and Peter Gent. 2010. <span>“The Parallel Ocean Program (<span>POP</span>) Reference Manual.”</span> <em>Los Alamos Unclassified Report LA-UR-02-2484</em>, January.
</div>
<!-- .element: style="font-size:20pt" -->
<!-- End adding with revealjs-make-reflist -->
